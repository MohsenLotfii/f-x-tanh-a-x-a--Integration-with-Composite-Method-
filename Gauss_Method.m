%========================== In The Name Of God ===========================%
%------------------------ Created by Mohsen Lotfi ------------------------%
%------------------------ Persian Gulf University ------------------------%
%---- Numerical Integral Of The Equation:f(x)=tanh(r*(x-r)), -r<x<2r -----%
%%
clear
clc
f=@(x) 4.5*tanh(3*(4.5*x+1.5)-9);

%% 3 Point:
% c =[ 0.5555555556 0.8888888889 0.5555555556];
% x0=[-0.7745966692 0.0000000000 0.7745966692];

% 5 Point:
% c =[ 0.2369268850561891 0.4786286704993665  0.2369268850561891  0.4786286704993665 0.5688888888888889];
% x0=[ 0.9061798459386640 0.5384693101056831 -0.9061798459386640 -0.5384693101056831 0.0000000000000000];

%% 7 Point:
c =[ 0.1294849661688697 0.1294849661688697 0.2797053914892766  0.2797053914892766 0.3818300505051189  0.3818300505051189 0.4179591836734694];
x0=[ 0.9491079123427585 -0.9491079123427585 0.7415311855993945 -0.7415311855993945 0.4058451513773972 -0.4058451513773972 0.0000000000000000];

%% Error:
integ=sum(c.*f(x0))
syms t
integral_exact = double(int(tanh(3*t-9),-3,6))
error_reletive = double(abs((integral_exact - integ)/integral_exact))
log_er = log(error_reletive)
N_point = [3 5 7];
loog_er = [-1.0996 -1.9572 -1.4632];
plot(N_point,loog_er,'-m*');
hold on
loog_er = [-4.9368e-04 -0.7378 -0.4058];
plot(N_point,loog_er,'-b*');
xlabel('N')
ylabel('Log Error')
title('Gauss Error')
legend ('Gauss','Simpson')
grid on